<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<!-- InstanceBegin template="/Templates/mcv_guide.dwt" codeOutsideHTMLIsLocked="false" -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<!-- InstanceBeginEditable name="doctitle" -->
<title>Scripting</title>
<!-- InstanceEndEditable --><!-- InstanceBeginEditable name="head" --><!-- InstanceEndEditable -->
<link rel="stylesheet" href="/mcidas/doc/mcv_guide/mcidasv.css" charset="ISO-8859-1" type="text/css">
<!-- InstanceBeginEditable name="CurrentFile" -->
<script language="javascript" type="text/javascript">
function setParentPage() { if (parent.setPage) parent.setPage('misc/Scripting.html',true); }
</script>
<!-- InstanceEndEditable -->
<style type="text/css">
<!--
.style1 {font-size: large;}
.style2 {font-size: small;}
-->
</style>
</head>
<body onLoad="setParentPage();">
<div class="TopTitleNav">
  <p class="style2" style="text-align:left; "> [<!-- InstanceBeginEditable name="GoToPrevious" --><a href="../Bundles.html">Go
        to Previous</a><!-- InstanceEndEditable -->] <span style="padding-left: 15px; "> [<!-- InstanceBeginEditable name="GoToNext" --><a href="../collab/Sharing.html">Go
        to Next</a><!-- InstanceEndEditable -->] </span> </p>
  <hr align="center">
</div>
<!-- InstanceBeginEditable name="MainContent" -->
<div class="pagetitle">Scripting</div>
<p>McIDAS-V can be scripted to create and manipulate images and movies. The scripting
  is accomplished using Jython. Jython is an implementation of the Python language
  in Java and follows Python syntax. </p>
<p>McIDAS-V scripting can be done from the <a href="../tools/JythonShell.html">Jython
    shell</a>, or a Jython script can be invoked as a command line argument.</p>
<p>In Unix, from the McIDAS-V-System directory: </p>
<pre>	runMcV -script /home/user/example.py </pre>
In Windows, from the McIDAS-V System directory (if running under a Windows machine,
it is necessary to use "\\" instead of "\" in scripts when specifying directory
paths to avoid Windows interpreting it as an escape sequence.):
<pre>	runMcV.bat -script C:\\home\\user\\example.py </pre>
<p>When invoked as a command line argument, the user interface will not be shown.
  However, McIDAS-V still needs to be run with an active window system (e.g.,
  X, MS Windows) for it to run. If running under a Linux/Unix machine with no X server running, McIDAS-V must be run under the X virtual
  frame buffer, xvfb. </p>
<p>&nbsp;</p>
<hr>
<p>McIDAS-V supports a number of functions and methods to load and display data,
  manipulate the display, and to save images. Download the example script
  to see how to use each one (<a href="example.py" target="_blank">example.py</a>).
  The following are supported in McIDAS-V.
<p>
<p><strong>Create an Object:</strong>
<ul>
  <li><a href="#buildWindow">buildWindow</a></li>
  <li><a href="#openBundle">openBundle</a></li>
  <li><a href="#makeLocalADDE">makeLocalADDEEntry</a></li>
  <li><a href="#getLocalADDE">getLocalADDEEntry</a></li>
  <li><a href="#getADDEImage">getADDEImage</a></li>
  <li><a href="#createLayer">createLayer</a></li>
</ul>
  <strong>Modify the Display Object:
  </strong>
  <ul>
  <li><a href="#annotate">annotate</a></li>
  <li><a href="#setCenter">setCenter</a></li>
  <li><a href="#setProjection">setProjection</a></li>
  <li><a href="#setWireframe">setWireframe</a></li>
  </ul>
  <strong>Modify the Layer Object:
  </strong>
  <ul>
  <li><a href="#setColorScale">setColorScale</a></li>
  <li><a href="#setEnhancement">setEnhancement</a></li>
  <li><a href="#setLayerLabel">setLayerLabel</a></li>
  <li><a href="#setLayerVisible">setLayerVisible</a></li>
  </ul>
  <strong>Save the Display:
  </strong>
  <ul>
  <li><a href="#captureImage">captureImage</a></li>
  <li><a href="#writeMovie">writeMovie</a></li>
</ul>
<strong>Environment:
  </strong>
  <ul>
  <li><a href="#printHistoryLength">getJythonShellMaxHistoryLength</a></li>
  <li><a href="#setHistoryLength">setJythonShellMaxHistoryLength</a></li>
  <li><a href="#collectGarbage">collectGarbage</a></li>
  <li><a href="#removeAllLayers">removeAllLayers</a></li>
  <li><a href="#removeAllData">removeAllData</a></li>
  <li><a href="#expandpath">expandpath</a></li>
</ul>
<hr>
<h3>Create an Object: </h3>
<p><strong><a name="buildWindow" id="buildWindow"></a></strong>
<strong>buildWindow -</strong> Creates
  a window and returns an array of panels (single panel currently supported)</p>
<div class="OneTabIndent">Usage: <em> panel=buildWindow(keywords)</em></div>
<div class="TwoTabIndent">Keywords:</div>
<div class="ThreeTabIndent">height= height of the window</div>
<div class="ThreeTabIndent">width= width of the window</div>
<div class="ThreeTabIndent">panelTypes= type of display to create</div>
<div class="FourTabIndent">MAP (default)</div>
<div class="FourTabIndent">GLOBE</div>
<div class="OneTabIndent">Example:</div>
<div class="TwoTabIndent"><em>panel=buildWindow(height=600,width=800,panelTypes=GLOBE)</em></div>
<div class="TwoTabIndent"><em>panel=buildWindow(height=600,width=800,panelTypes=MAP)</em></div>
<p><strong><a name="openBundle" id="openBundle"></a>openBundle -</strong> Creates
  a new window and displays contents of a bundle</p>
<div class="OneTabIndent">Usage: <em>openBundle(bundle file, keywords)</em></div>
<div class="TwoTabIndent">bundle file - file name of bundle (required)</div>
<div class="TwoTabIndent">Keywords:</div>
<div class="ThreeTabIndent">height= height of display; default= height of the
  display window when the bundle was saved</div>
<div class="ThreeTabIndent">width= width of display; default= width of the display
  window when the bundle was saved</div>
<div class="ThreeTabIndent">dataDictionary= a dictionary where the keys are datasource
  names,  and the values are either a string or list of strings representing
  the full path name/names  of the data that will be used in place of the data
  in the bundle
</div>
<p><strong><a name="makeLocalADDE" id="makeLocalADDE"></a>makeLocalADDEEntry -</strong> Creates a local ADDE entry in the server table</p>
<div class="OneTabIndent">Usage: <em>localDataset= makeLocalADDEEntry(keywords)</em></div>
<div class="TwoTabIndent">Keywords:</div>
<div class="ThreeTabIndent">dataset= name of the dataset - limit of 8 characters</div>
<div class="ThreeTabIndent">imageType = image type name for local server entry. (default=<em>format_dataset</em>)</div>
<div class="ThreeTabIndent">save = True - saves entry into the server table<br>
&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; False - entry is removed after McIDAS-V session is ended (default)</div>
<div class="ThreeTabIndent">mask= directory containing the files used by the created dataset</div>
<div class="ThreeTabIndent">format= data format of files within the dataset. Either Full Name or Short Name can be used as valid options:</div>
<div class="ThreeTabIndent"><table width="525" border="1">
    <tr>
        <th width="420" scope="col"><strong>Full Name</strong></th>
        <th width="105" scope="col"><strong>Short Name</strong></th>
    </tr>
    <tr>
        <td>&quot;AMSR-E L1b&quot;</td>
        <td>&quot;AMSR&quot;</td>
    </tr>
    <tr>
        <td>&quot;LRIT GOES-9&quot;</td>
        <td>&quot;FSDX_G9&quot;</td>
    </tr>
    <tr>
        <td>&quot;LRIT GOES-10&quot;</td>
        <td>&quot;FSDX_G10&quot;</td>
    </tr>
    <tr>
        <td>&quot;LRIT GOES-11&quot;</td>
        <td>&quot;FSDX_G11&quot;</td>
    </tr>
    <tr>
        <td>&quot;LRIT GOES-12&quot;</td>
        <td>&quot;FSDX_G12&quot;</td>
    </tr>
    <tr>
        <td>&quot;LRIT MET-5&quot;</td>
        <td>&quot;FSDX_M5&quot;</td>
    </tr>
    <tr>
        <td>&quot;LRIT MET-7&quot;</td>
        <td>&quot;FSDX_M7&quot;</td>
    </tr>
    <tr>
        <td>&quot;LRIT MTSAT-1R&quot;</td>
        <td>&quot;FSDX_MT&quot;</td>
    </tr>
    <tr>
        <td>&quot;McIDAS Area&quot;</td>
        <td>&quot;AREA&quot;</td>
    </tr>
    <tr>
        <td>&quot;Meteosat OpenMTP&quot;</td>
        <td>&quot;OMTP&quot;</td>
    </tr>
    <tr>
        <td>&quot;Metop AVHRR L 1b&quot;</td>
        <td>&quot;LV1B_METOP&quot;</td>
    </tr>
    <tr>
        <td>&quot;MODIS MOD 02 - Level 1B Calibrated Geolocated Radiances&quot;</td>
        <td>&quot;MODS&quot;</td>
    </tr>
    <tr>
        <td>&quot;MODIS MOD 04 - Aerosol Product&quot;</td>
        <td>&quot;MOD4&quot;</td>
    </tr>
    <tr>
        <td>&quot;MODIS MOD 06 - Cloud Product&quot;</td>
        <td>&quot;MODX_06&quot;</td>
    </tr>
    <tr>
        <td>&quot;MODIS MOD 07 - Atmospheric&nbsp;Profiles&quot;</td>
        <td>&quot;MODX_07&quot;</td>
    </tr>
    <tr>
        <td>&quot;MODIS MOD 28 - Sea Surface Temperature&quot;</td>
        <td>&quot;MOD8&quot;</td>
    </tr>
    <tr>
        <td>&quot;MODIS MOD 35 - Cloud Mask&quot;</td>
        <td>&quot;MODX_35&quot;</td>
    </tr>
    <tr>
        <td>&quot;MODIS MOD R - Corrected Reflectance&quot;</td>
        <td>&quot;MODR&quot;</td>
    </tr>
    <tr>
        <td>&quot;MSG HRIT FD&quot;</td>
        <td>&quot;MSGT_FD&quot;</td>
    </tr>
    <tr>
        <td>&quot;MSG HRIT HRV&quot;</td>
        <td>&quot;MSGT_HRV&quot;</td>
    </tr>
    <tr>
        <td>&quot;MTSAT HRIT&quot;</td>
        <td>&quot;MTST&quot;</td>
    </tr>
    <tr>
        <td>&quot;NOAA AVHRR L 1b&quot;</td>
        <td>&quot;LV1B_NOAA&quot;</td>
    </tr>
    <tr>
        <td>&quot;SSMI&quot;</td>
        <td>&quot;SMIN&quot;</td>
    </tr>
    <tr>
        <td>&quot;TRMM&quot;</td>
        <td>&quot;TMIN&quot;</td>
    </tr>
    <tr>
        <td>&quot;GINI&quot;</td>
        <td>&quot;GINI&quot;</td>
    </tr>
</table></div>
<div class="OneTabIndent">Example:</div>
<div class="TwoTabIndent"><em>dataPath = 'C:\\Users\\myuser\\Data\\AREA'</em></div>
<div class="TwoTabIndent"><em>makeLocalADDEEntry(dataset='AREA', imageType='Area files', save=True, mask=dataPath, format='McIDAS Area')</em></div>
<p><strong><a name="getLocalADDE" id="getLocalADDE"></a>getLocalADDEEntry -</strong> Gets the descriptor for a local ADDE entry</p>
<div class="OneTabIndent">Usage: <em>localDescriptor= getLocalADDEEntry(keywords)</em></div>
<div class="TwoTabIndent">Keywords:</div>
<div class="ThreeTabIndent">dataset= local ADDE entry dataset name</div>
<div class="ThreeTabIndent">imageType= image type of local ADDE entry</div>
<div class="OneTabIndent">Example:</div>
<div class="TwoTabIndent"><em>desc = getLocalADDEEntry(dataset='AREA',imageType='Area files')</em></div>
<div class="ThreeTabIndent">Note: Should be used after makeLocalADDEEntry. Once you run this command, you can use <em>localEntry=desc</em> in your getADDEImage command.</div>
<p><strong><a name="getADDEImage" id="getADDEImage"></a>getADDEImage -</strong> Requests
  data from an ADDE Image server - returns both data and metadata objects</p>
<div class="OneTabIndent">Usage: <em>myMetaData,myData= getADDEImage(keywords)</em></div>
<div class="TwoTabIndent">Keywords:</div>
<div class="ThreeTabIndent">localEntry = local dataset defined by makeLocalADDEEntry</div>
<div class="ThreeTabIndent">server= ADDE server</div>
<div class="ThreeTabIndent">dataset= ADDE dataset group name</div>
<div class="ThreeTabIndent">descriptor= ADDE dataset descriptor</div>
<div class="ThreeTabIndent">day= day range ('begin date','end date')</div>
<div class="ThreeTabIndent">time= ('begin time','end time')</div>
<div class="ThreeTabIndent">coordinateSystem= coordinate system to use for retrieving
  data
<div class="OneTabIndent">AREA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AREA file coordinates - zero
  based</div>
<div class="OneTabIndent">LATLON&nbsp;&nbsp;&nbsp;latitude and longitude coordinates</div>
<div class="OneTabIndent">IMAGE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;image coordinates
  - one based</div></div> 
<div class="ThreeTabIndent">location=(x,y)<br>
</div>
<div class="FourTabIndent">x&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; AREA
  line, latitude, or IMAGE line</div>
<div class="FourTabIndent">y&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; AREA
  element, longitude, or IMAGE element</div>
<div class="ThreeTabIndent">place = CENTER places specified location (x,y) at
  center of panel</div>
<div class="FourTabIndent">&nbsp;ULEFT places specified location (x,y) at upper-left
  coordinate of panel</div>
<div class="ThreeTabIndent">band= McIDAS band number; must be specified if requesting
  data from multi-banded image; default=band in image </div>
<div class="ThreeTabIndent">unit= calibration unit to request; default = 'BRIT'</div>
<div class="ThreeTabIndent">position= time relative (negative values) or absolute
  (positive values) position in the dataset; default=0 (most recent image)</div>
<div class="ThreeTabIndent">size= number of lines and elements to request; default=(480,640)</div>
<div class="ThreeTabIndent">mag= magnification of data (line,element), negative
  number used for sampling data; default=(1,1)</div>
<div class="ThreeTabIndent">accounting= ('user', 'project number') user and project
  number required by servers using McIDAS accounting; default = ('idv','0')</div>
  <div class="ThreeTabIndent">debug= send debug information to file; default=False</div>
  <div class="OneTabIndent">Examples:</div>
  <div class="TwoTabIndent"><em>metadata,data = getADDEImage(debug=True,localEntry=desc, size='ALL', mag=(1,1), unit='BRIT')</em></div>
<p><strong><a name="createLayer" id="createLayer"></a>createLayer -</strong> Creates
  a new data layer in a panel</p>
<div class="OneTabIndent">Usage: <em>myDataLayer = panel[0].createLayer(display
    type, myData)</em></div>
<div class="TwoTabIndent">display type - display type for layer; valid options
  shown in Field Selector (e.g. 'Image Display', 'Image Sequence Display')</div>
<div class="TwoTabIndent">myData - data object to display (from getADDEImage)</div>
<div class="OneTabIndent">Examples:</div>
<div class="TwoTabIndent"><em>layer=panel[0].createLayer('Image Display', data)</em></div>
<div class="ThreeTabIndent">Note: This is used in conjunction with getLocalADDEEntry.</div>
<p>&nbsp;</p>
<h3>Modify the Display Object: </h3>
<p><strong><a name="annotate" id="annotate"></a>annotate -</strong> Writes text
  to a panel</p>
<div class="OneTabIndent">Usage: <em>panel[0].annotate(text,keywords)</em></div>
<div class="TwoTabIndent">text - annotation string </div>
<div class="TwoTabIndent">Keywords:</div>
<div class="ThreeTabIndent">lat=, lon= Start text string at specified latitude and longitude (must be used together)</div>
<div class="ThreeTabIndent">line=, element= Start text string at specified panel
   line and element (must be used together)</div>

<div class="ThreeTabIndent">font= name of font; default is system dependent </div>
<div class="ThreeTabIndent">size= size of font; default 12 </div>
<div class="ThreeTabIndent">  color= 'color name'; default='red'<br>
</div>
<div class="FourTabIndent">-or- </div>
<div class="FourTabIndent">[R,G,B] fractional scaling factor for each red, green
  and blue value (0 to 1)</div>
<div class="OneTabIndent">Example:</div>
<div class="TwoTabIndent"><em>panel[0].annotate('EQUATOR',size=20, font='SansSerif.bold', lat=0, lon=-90, color='Red')</em></div>
<div class="ThreeTabIndent">Note: This is used in conjunction with buildWindow</div>
<p><strong><a name="setCenter" id="setCenter"></a>setCenter -&nbsp;</strong>
Centers the display on a specified latitude/longitude and sets a scaling factor</p>
<div class="OneTabIndent">Usage: <em>panel[0].setCenter(latitude,longitude,keywords) </em></div>
<div class="TwoTabIndent">latitude - centers the display at the specified latitude (no default, required parameter) </div>
<div class="TwoTabIndent">longitude - centers the display at the specified longitude (no default, required parameter) </div>
<div class="TwoTabIndent">Keywords:</div>
<div class="ThreeTabIndent">  scale= scale factor for map; default=current scale factor<br>
  Scale factors between 0 and 1 zoom out centered on the specified
  latitude/longitude and scale factors greater than 1 zoom in.</div>
<div class="OneTabIndent">Example:</div>
<div class="TwoTabIndent"><em>panel[0].setCenter(latitude=45, longitude=-75, scale=20</em></div>
<div class="ThreeTabIndent">Note: This is used in conjunction with buildWindow</div>
<p><strong><a name="setProjection" id="setProjection"></a>setProjection -</strong> Sets
  the projection of a panel</p>
<div class="OneTabIndent">Usage: <em>panel[0].setProjection(projection)</em></div>
<div class="TwoTabIndent">projection - &nbsp; string specifying the projection;
  e.g., 'US&gt;Southeastern U.S.'</div>
<div class="FourTabIndent">-or-</div>
<div class="FourTabIndent"> the name of the layer returned by createLayer, which
  uses the default projection of that data </div>
  <div class="OneTabIndent">Example:</div>
  <div class="TwoTabIndent"><em>panel[0].setProjection('US>States>N-Z>Pennsylvania')</em></div>
  <div class="ThreeTabIndent">Note: This is used in conjunction with buildWindow</div>
<p><strong><a name="setWireframe" id="setWireframe"></a>setWireframe -</strong> Turns
  wire frame box on or off</p>
<div class="OneTabIndent">Usage: <em>panel[0].setWireframe(visible)</em></div>
<div class="TwoTabIndent">visible - True displays wire frame box, False turns
  off wire frame box</div>
<div class="OneTabIndent">Example:</div>
<div class="TwoTabIndent"><em>panel[0].setWireframe(False)</em></div>
<div class="TwoTabIndent"><em>panel[0].setWireframe(True)</em></div>
<div class="ThreeTabIndent">Note: This is used in conjunction with buildWindow</div>
<p>&nbsp;</p>
<h3>Modify the Layer Object: </h3>
<p><strong><a name="setColorScale" id="setColorScale"></a>setColorScale -</strong> Displays
  color scale on a panel and specifies its attributes</p>
<div class="OneTabIndent">Usage: <em>myDataLayer.setColorScale(keywords)</em></div>
<div class="TwoTabIndent">Keywords:</div>
<div class="ThreeTabIndent">visible= True displays color scale (default)</div>
<div class="ThreeTabIndent">placement= location of color scale  <br>
  <div class="OneTabIndent">
  'Top'  (default)<br>
  'Bottom'<br>
  'Left'<br>
  'Right'</div></div>
<div class="ThreeTabIndent">font= name of font; default=font defined in user
  preferences</div>
<div class="ThreeTabIndent">  style= font style; default=font defined in user
      preferences </div>
  <div class="FourTabIndent">'BOLD' bolded font</div>
<div class="FourTabIndent">'ITALIC' italicized font</div>
<div class="FourTabIndent">'NONE' </div>
<div class="ThreeTabIndent">size= size of font; default=size of font defined
  in user preferences</div>
<div class="ThreeTabIndent">  color= 'color name'; default=color defined in user
preferences<br></div>
<div class="FourTabIndent">-or- </div>
<div class="FourTabIndent">[R,G,B] fractional scaling factor for each red, green
  and blue value (0 to 1)</div>
  <div class="OneTabIndent">Example:</div>
  <div class="TwoTabIndent"><em>layer.setColorScale(placement='left',font='SansSerif',size=18.0,color='green'</em></div>
  <div class="ThreeTabIndent">Note: This is used in conjunction with createLayer.</div>
<p><strong><a name="setEnhancement" id="setEnhancement"></a>setEnhancement -&nbsp;</strong>Applies
  a color table and defines data range of data in a layer<br>
<div class="OneTabIndent">Usage: <em>myDataLayer.setEnhancement(color table,keywords)</em></div>
<div class="TwoTabIndent">color table - color table name e.g., 'Longwave Infrared
  Deep Convection'</div>
<div class="TwoTabIndent">Keywords:</div>
<div class="ThreeTabIndent">range=(min,max) enhancement range; default= (min,max)
  of data</div>
  <div class="OneTabIndent">Example:</div>
  <div class="TwoTabIndent"><em>layer.setEnhancement('Longwave Infrared Deep Convection',range=(20,250))</em></div>
  <div class="ThreeTabIndent">Note: This is used in conjunction with createLayer</div>
<p><strong><a name="setLayerLabel" id="setLayerLabel"></a>setLayerLabel -</strong> Toggles
  a layer label on/off and defines its attributes</p>
<div class="OneTabIndent">Usage: <em>myDataLayer.setLayerLabel(label,keywords)</em></div>
<div class="TwoTabIndent">label - layer label string </div>
<div class="TwoTabIndent">Keywords:</div>
<div class="ThreeTabIndent">visible= True displays layer label</div>
<div class="ThreeTabIndent">font= name of font; default=font defined in user
  preferences</div>
<div class="ThreeTabIndent">  style= font style; default=font defined in user
preferences </div>
  <div class="FourTabIndent">'BOLD' bolded font</div>
<div class="FourTabIndent">'ITALIC' italicized font</div>
<div class="FourTabIndent">'NONE' </div>
<div class="ThreeTabIndent">size= size of font; default=size of font defined
  in user preferences</div>
<div class="ThreeTabIndent">  color= 'color name'; default=color defined in user
preferences<br></div>
<div class="FourTabIndent">-or- </div>
<div class="FourTabIndent">[R,G,B] fractional scaling factor for each red, green
  and blue value (0 to 1)</div>
  <div class="OneTabIndent">Example:</div>
  <div class="TwoTabIndent"><em>layer.setLayerLabel(label='%displayname% %timestamp%', size=15, color=blue', style='BOLD'</em></div>
  <div class="ThreeTabIndent">Note: This is used in conjunction with createLayer</div>
<p><strong><a name="setLayerVisible" id="setLayerVisible"></a>setLayerVisible
    -</strong> Toggles layer visibility on/off</p>
<div class="OneTabIndent">Usage: <em>myDataLayer.setLayerVisible(visible)</em></div>
<div class="TwoTabIndent">visible - True displays layer</div>
<div class="ThreeTabIndent"> &nbsp;&nbsp;False turns off layer</div>
<div class="OneTabIndent">Example:</div>
<div class="TwoTabIndent"><em>layer.setLayerVisible(False)</em></div>
<div class="ThreeTabIndent">Note: This is used in conjunction with createLayer</div>
<p>&nbsp;</p>
<h3>Save the Display: </h3>
<p><strong><a name="captureImage" id="captureImage"></a>captureImage -</strong> Writes
  panel display to a file</p>
<div class="OneTabIndent">Usage:<em> panel[0].captureImage(file, keywords)</em></div>
<div class="TwoTabIndent">file - name of file, file format determine by file
  extension; valid options: .jpg, .gif, .png, .pdf, .svg, .kml, .kmz</div>
<div class="TwoTabIndent">Keywords:</div>
<div class="ThreeTabIndent">height= height of image (default - see Remarks)</div>
<div class="ThreeTabIndent">width= width of image (default - see Remarks)</div>
<div class="ThreeTabIndent">quality= quality of jpg file (0.0 to 1.0); default=1.0;
  not used with other formats</div>
<div class="OneTabIndent">Remarks:</div>
<div class="TwoTabIndent">If captureImage is used to save a panel that was created
  with openBundle, the sizes default to size of the display window when the bundle
  was saved. If data was loaded using createLayer, the sizes default to those
  defined in buildWindow.</div>
  <div class="OneTabIndent">Example:</div>
  <div class="TwoTabIndent"><em>panel[0].captureImage("C:\\Users\\myuser\\Image.png"</em>)</div>
</p>
<p><strong><a name="writeMovie" id="writeMovie"></a>writeMovie -</strong> Writes
  an image sequence to a movie file (ISL function) <br>
<div class="OneTabIndent">Usage:<em> writeMovie(file,keywords) </em></div>
<div class="TwoTabIndent">file - name of file, file format determine by file
  extension; valid options: .gif, .mov</div>
<div class="TwoTabIndent">Keywords:</div>
<div class="ThreeTabIndent">resize width= height= &nbsp;&nbsp;frame size of the movie</div>
<div class="OneTabIndent">Example:</div>
<div class="TwoTabIndent"><em>writeMovie("C:\\Users\\myuser\\movie.gif')</em></div>
<p>&nbsp;</p>
<h3>Environment: </h3>
<p><strong><a name="printHistoryLength" id="printHistoryLength"></a>getJythonShellMaxHistoryLength( ) -</strong> Returns the current number of commands that are saved.
<div class="OneTabIndent">Usage: <em>print getJythonShellMaxHistoryLength()</em></div>
<p><strong><a name="setHistoryLength" id="setHistoryLength2"></a>setJythonShellMaxHistoryLength( ) -</strong> Sets the number of commands that will be saved.</p>
<div class="OneTabIndent">Usage: <em>setJythonShellMaxHistoryLength(number)</em></div>
<div class="OneTabIndent">Remarks:</div>
<div class="TwoTabIndent">This is the number of commands that will be listed out with the <strong>File>List Saved History</strong> menu item in the Jython Shell, as well as the number that will be added to the Local Jython Library from the <strong>File>Save Commands to Jython Library</strong> menu item. The default number of commands saved to the history is 100.</div>
<div class="OneTabIndent">Example:</div>
<div class="TwoTabIndent"><em>setJythonShellMaxHistoryLength(25)</em></div>
<p><strong><a name="collectGarbage" id="collectGarbage"></a>collectGarbage( ) -</strong> Performs a garbage collection to free up memory.</p>
<div class="OneTabIndent">Usage: <em>collectGarbage()</em></div>
<p><strong><a name="expandpath" id="expandpath"></a>expandpath( ) -</strong> Expands the path entered.</p>
<div class="OneTabIndent">Usage: <em>expandpath(path)</em></div>
<div class="OneTabIndent">Remarks:</div>
<div class="TwoTabIndent">Understands environmental variables such as &quot;~&quot; and &quot;..&quot;.&nbsp;For example, on Windows, &nbsp;'print expandpath(&quot;$HOMEPATH&quot;)' will print \Users\username.</div>
<p><strong><a name="removeAllData" id="removeAllData"></a>removeAllData( ) -</strong> Removes all data sources added during the current session, without removing any displays.</p>
<div class="OneTabIndent">Usage: <em>removeAllData()</em></div>
<p><strong><a name="removeAllLayers" id="removeAllLayers"></a>removeAllLayers( ) -</strong> Removes all layers that have been displayed.</p>
<div class="OneTabIndent">Usage: <em>removeAllLayers()</em></div>
<p>For users looking for more functionality from McIDAS-V scripting, additional
  functions can be found in the Java docs for 
  <a href="http://www.ssec.wisc.edu/visad-docs/javadoc/index.html" target="_blank">visAD</a>, 
  <a href="http://www.unidata.ucar.edu/software/netcdf-java/v4.2/javadocAll/index.html" target="_blank">netCDF</a>, 
  <a href="http://www.unidata.ucar.edu/software/idv/docs/javadoc/index.html" target="_blank">IDV</a>,
  and <a href="http://www.ssec.wisc.edu/mcidas/software/v/javadoc/current/" target="_blank">McIDAS-V</a>.
  Please send any questions or requests for functionality to the 
  <a href="http://dcdbs.ssec.wisc.edu/mcidasv/forums/viewforum.php?f=31" target="_blank">McIDAS-V
  Support Forum on scripting</a>. </p>
<!-- InstanceEndEditable -->
<div class="BottomTitleNav">
  <hr align="center">
  <p class="style2" style="text-align:left; "> [<!-- InstanceBeginEditable name="GoToPrevious2" --><a href="../Bundles.html">Go
        to Previous</a><!-- InstanceEndEditable -->] <span style="padding-left: 15px; "> [<!-- InstanceBeginEditable name="GoToNext2" --><a href="../collab/Sharing.html">Go
        to Next</a><!-- InstanceEndEditable -->] </span></p>
</div>
</body>
<!-- InstanceEnd -->
</html>
