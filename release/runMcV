#!/bin/sh

dirname=`dirname $0`
cd $dirname
X_BOOT_CLASS_PATH=""

################################################################################
# Look for MacOS Java3D/JOGL package.  If present, expand it.
if [ `uname -s` = "Darwin" ]; then
	if [ -d "jogl" -a -d "java3d" ]; then
		JOGL_LIB=${PWD}/jogl
		JOGL_CP=${JOGL_LIB}:${JOGL_LIB}/jogl.jar:${JOGL_LIB}/gluegen-rt.jar
		export DYLD_LIBRARY_PATH=${JOGL_LIB}
		JAVA3D_LIB=${PWD}/java3d
		JAVA3D_CP=${JAVA3D_LIB}/j3dcore.jar:${JAVA3D_LIB}/j3dutils.jar:${JAVA3D_LIB}/vecmath.jar
		X_BOOT_CLASS_PATH="-Xbootclasspath/p:${JOGL_CP}:${JAVA3D_CP}"
	fi
fi
# Done with MacOS Java3D/JOGL package.
################################################################################

command="java ${X_BOOT_CLASS_PATH} -Xmx512m -Xdock:name=McIDAS-V -cp idv.jar -jar mcidasv.jar $*"

if test -f jre/bin/java; then
##We are in the installer directory
    ./jre/bin/${command}
else
##Try using the dirname of this script
    if test -f ${dirname}/jre/bin/java; then
       pushd ${dirname} > /dev/null
       ./jre/bin/${command}
       popd > /dev/null
    else 
       if test  ${JAVA_HOME}; then
##Try using JAVA_HOME
          ${JAVA_HOME}/bin/${command}
       else 
##Try just using java
          ${command}
      fi
    fi
fi
